//20.60.3.w.1 and j = -110349050625/1024
P<x,y,z>:=ProjectiveSpace(Rationals(),2);
P1 := ProjectiveSpace(Rationals(),1);
j := [249999148631348037126872231808*x^16-2326992889797485410199739963392*x^15*y+30928897686714550786198957584384*x*y^15-28821266968650120727310227851136*y^16+19693089868165682823486253778944*x^15*z-54628046279250749009215641047040*x^14*y*z+2306429546126553567589863468001280*x*y^14*z-1842875176315925562207067892594688*y^15*z+223897974595661682819335638371200*x^14*z^2-403817454800208223354706954561792*x^13*y*z^2+45278793499396940185828210157526016*x*y^13*z^2-28837331398067227608228702030020224*y^14*z^2+1011266910560615245039981394765056*x^13*z^3-1586088824450841302959800294059264*x^12*y*z^3+265610711488485637367308746126207744*x*y^12*z^3-87395971899800969972757145026540544*y^13*z^3+1720720047827378732632713003645184*x^12*z^4-4769289035003381634101746348944640*x^11*y*z^4-565176006058054896868976181622620160*x*y^11*z^4+857288402737565168381585667370683136*y^12*z^4-4491828276695026418868992672969984*x^11*z^5-17246761718339927227356641696229632*x^10*y*z^5-10060152903744698688471442716562584576*x*y^10*z^5+4877851909382285332709148271560552448*y^11*z^5-45590313013745430141021815111571200*x^10*z^6-75377201791474668839238702389338880*x^9*y*z^6-21618165269383654823746013158565835776*x*y^9*z^6-3256331932163453464365207407864351488*y^10*z^6-204275427771403264056463129728216832*x^9*z^7-258687311731721674916269661704342272*x^8*y*z^7+85940051484876793131225469597191302656*x*y^8*z^7-71415508962193747091628460068173575168*y^9*z^7-708015101561646438203077083661243520*x^8*z^8-2607712916913044931353462600713168640*x^7*y*z^8+551506421491173960413413675686745291776*x*y^7*z^8-174436467039904952114055052119362313088*y^8*z^8-9171463912989184434212152993235052288*x^7*z^9+43556252746429756497564420881299367168*x^6*y*z^9+926635466333112176494935859245920374784*x*y^6*z^9+170502070690242941311485588196072184832*y^7*z^9+392882167703729877309776342267600961920*x^6*z^10+385169824396213718619788358549686952960*x^5*y*z^10-6534734991884807631555172640580839101440*x*y^5*z^10+5260694025471197069092791207848692236672*y^6*z^10-1251885860194627116613668479746310784512*x^5*z^11-4143296236493497178601349351956631435264*x^4*y*z^11-12735769108590656623809863920121681401088*x*y^4*z^11-10178087089445661844146098193978942909440*y^5*z^11-8455896027594493634918578057929879523840*x^4*z^12+21015395378196944122090220194381195759616*x^3*y*z^12+21433794984866365597976478400231275520000*x*y^3*z^12+804617462435263721379625331614674022400*y^4*z^12+14100432566227684792579512679880352886784*x^3*z^13+4479584291893024782431219388665943902208*x^2*y*z^13+21935149083753823471270159785170380849152*x*y^2*z^13+8551176129895028777969254910851116288000*y^3*z^13+4237470025099522490638707778157009528832*x^2*z^14-17820938438733719550139418746824733872128*x*y*z^14-4365411335430681442167031020483731879936*y^2*z^14-8730822563005066724338571841031140634624*x*z^15+10387520541411664409674399858688*y*z^15-1105705562754394049072336961536*z^16, -806254858020272327665777*x*y^15+771626475205180949202753*y^16-112216060961502319836125005*x*y^14*z+94949352276964388639222669*y^15*z-2889331511389666901902722049*x*y^13*z^2+1924762412104432351081000394*y^14*z^2-10600753176561937902471657703*x*y^12*z^3-246393617970978803213738671*y^13*z^3+134930299890465696454123085807*x*y^11*z^4-105730471604794149831593232574*y^12*z^4+484319758291100688038938639911*x*y^10*z^5+17500671254818011923108560569*y^11*z^5-2182194709159227684550367589393*x*y^9*z^6+1836450000308445353861818840854*y^10*z^6+103200621826594857941219456*x^8*y*z^7-8504877504103196478802847704179*x*y^8*z^7+427239059614432090467873856021*y^9*z^7+14166119425419770616028095872*x^8*z^8+172402497461094157973159441408*x^7*y*z^8+4563654794519764842838410820789*x*y^7*z^8-10670268764112666539630297040712*y^8*z^8+381151156044881422814040587008*x^7*z^9-4916250263411122707194162393728*x^6*y*z^9+79276544878846174041081586657529*x*y^6*z^9-33401938375317732166993320328185*y^7*z^9-12632136149543310114699588497280*x^6*z^10+37491954314649379139312657120256*x^5*y*z^10+193682857237104693077040125100389*x*y^5*z^10+23394196518990236909082138551542*y^6*z^10+114498040342053726603310965089280*x^5*z^11-1609577682760425554563056812160*x^4*y*z^11-747266846862582097473564852648453*x*y^4*z^11+592159370036543092277384172023587*y^5*z^11-402417401676415738213484799004928*x^4*z^12-619198559800046225479202328822272*x^3*y*z^12+370128905043385012599489938714061*x*y^3*z^12-2180900241386961485591542279478458*y^4*z^12+2269316668828890786827339057125632*x^3*z^13-3356379417563689862577307533108224*x^2*y*z^13+4281574364658967030248832733414189*x*y^2*z^13+2705973024342651366898049476002803*y^3*z^13-738012761110541200669145458562432*x^2*z^14-3377904893526500193902836952458835*x*y*z^14-1098731523643966916209280617352662*y^2*z^14-2197463595237274417738477211747745*x*z^15+273508508508002668734481719*y*z^15+33743455894604310579600127*z^16];
eqns := [-2*x^3*z + x^2*y^2 + 4*x^2*y*z + x^2*z^2 - 2*x*y^3 - 2*x*y^2*z + 4*x*y*z^2 + 2*x*z^3 + y^4 - 2*y^3*z + y^2*z^2];
C := Curve(P,eqns[1]);
jmap := map<C->P1 | [j[1], j[2]]>;
A := AutomorphismsOfPlaneQuartic(C);
M := A[2];
vars := [x,y,z];
L := [ &+[ M[i][j]*vars[j] : j in [1..3] ] : i in [1..3] ];
phi := map<C->C | L>;
pts := PointSearch(C, 1000);
//find the point with the j-invariant
exists(Q){Q : Q in pts | jmap(Q) eq P1![-110349050625/1024,1] };
//apply automorphism, get point with CM by -3
jmap(phi(Q));

//show that there are no other rational points
j := P1![-110349050625/1024,1];
inv_im := j@@jmap;
assert Dimension(inv_im) eq 0;
assert #RationalPoints(inv_im) eq 1;

//28.32.2.a.1 (genus 2 curve that is a covered by genus 3 curve) and j = 351/4, j=-38575685889/16384
P<x,y,z,w>:=ProjectiveSpace(Rationals(),3);
P1 := ProjectiveSpace(Rationals(), 1);
eqns := [2*x^2*y-x*y^2+2*y^3+2*x^2*z-x*y*z+y^2*z-y*z^2+x^2*w-x*y*w-y^2*w+3*x*z*w+y*z*w-x*w^2, 2*x^2*y-x*y^2-3*y^3+2*x^2*z+4*x*y*z+3*y^2*z-2*x*z^2-y*z^2-2*x*y*w+x*z*w, 2*x^2*y+9*x*y^2-3*y^3+2*x^2*z-5*x*y*z+3*y^2*z-y*z^2+3*x^2*w-x*y*w+x*z*w, 2*x^2*y-x*y^2+7*y^3+2*x^2*z+4*x*y*z-6*y^2*z-2*x*z^2+y*z^2+x*y*w+y^2*w+x*z*w, 5*y^3+5*x*y*z+3*y^2*z-2*x*z^2-7*y*z^2+2*z^3-x^2*w+2*x*y*w+2*y^2*w+x*z*w+x*w^2, 2*x^2*y-x*y^2+2*y^3+2*x^2*z-x*y*z+y^2*z-y*z^2+x^2*w-x*y*w+9*y^2*w+3*x*z*w-8*y*z*w+2*z^2*w+2*x*w^2+y*w^2];
j := [130614400000000000*x^7-99881600000000000*x^6*z-55977600000000000*x^6*w-122931200000000000*x^5*z*w-477024800000000000*x^5*w^2-1112064800000000000*x^4*z*w^2+197387926310400000*x^4*w^3+394110356677800000*x^3*z*w^3+277763466735600000*x^3*w^4+1301844259231725200*x^2*z*w^4-207339576407639620*x^2*w^5+115528051941719310*x*y*w^5+1389879324467200000*x*z^6-1695807243571700000*x*z^5*w+1251162780491750000*x*z^4*w^2-880869154427673600*x*z^3*w^3+502320398906296910*x*z^2*w^4-374656451590002785*x*z*w^5+96371895233205741*x*w^6+1223471152367100000*y*z^6-2759228863259750000*y*z^5*w+2038438633988750000*y*z^4*w^2-682108298581565450*y*z^3*w^3-190611837352195895*y*z^2*w^4+340220211204822902*y*z*w^5-74743987053512293*y*w^6-960670392456600000*z^7+2382474277455300000*z^6*w-2197883256738400000*z^5*w^2+991193000528510500*z^4*w^3-64080431766090230*z^3*w^4-257052774107024586*z^2*w^5+114287600000000000*z*w^6-15366400000000000*w^7, 133280000000000*x^5*w^2+297920000000000*x^4*z*w^2-56255270400000*x^4*w^3-102093447400000*x^3*z*w^3+79252400000000*x^3*w^4+315695033018800*x^2*z*w^4-50957507310780*x^2*w^5-5305822059110*x*y*w^5+8482252800000*x*z^6-37149760620000*x*z^5*w+91090806450000*x*z^4*w^2-164844693518400*x*z^3*w^3+167630755828290*x*z^2*w^4-61374963333915*x*z*w^5+8818499575479*x*w^6+2084692260000*y*z^6+18129734910000*y*z^5*w-76396073950000*y*z^4*w^2+134395684607450*y*z^3*w^3-72650245298005*y*z^2*w^4+29690063656938*y*z*w^5-3779481440767*y*w^6+213496920000*z^7-11664298100000*z^6*w+40076845200000*z^5*w^2-67994028658500*z^4*w^3+31663349175630*z^3*w^4-7558962881534*z^2*w^5];

C := Curve(P, eqns);
jmap := map<C->P1 | [j[1]*(-1), j[2]*5]>;

smallpts := PointSearch(C, 1000);
exists(Q1){Q : Q in smallpts | jmap(Q) eq P1![351/4,1] };
exists(Q2){Q : Q in smallpts | jmap(Q) eq P1![-38575685889/16384,1] };

//show that there are no rational points other than the ones we expect
j1 := P1![351/4,1] ;
j2 :=  P1![-38575685889/16384,1];
inv_im1 := j1 @@jmap;
inv_im2 := j2 @@jmap;
assert Dimension(inv_im1) eq 0;
assert #RationalPoints(inv_im1) eq 1;
assert Dimension(inv_im2) eq 0;
assert #RationalPoints(inv_im2) eq 1;

A := AutomorphismGroup(C);
jmap((A.1)(Q1)); //cusp after applying automorphism
jmap((A.2)(Q1)); //cusp after applying automorphism

jmap((A.1)(Q2)); //cusp after applying automorphism
jmap((A.2)(Q2)); //cusp after applying automorphism
